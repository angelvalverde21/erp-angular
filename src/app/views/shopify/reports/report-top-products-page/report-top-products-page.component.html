@if(loading){
<app-loading></app-loading>
}@else{
<div class="card">

    <div class="card-header bg-primary text-white py-3">
        Top Ventas Ultimos 3 Meses
    </div>

    <div class="card-body">

        <input type="text" class="search-box form-control mb-3" placeholder="Buscar producto..." [(ngModel)]="searchTerm" />

        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <td class="align-middle">Nombre</td>
                        <td class="text-center align-middle">Image</td>
                        <td class="text-center align-middle">Talla</td>
                        <!-- <td class="text-center align-middle">Total Vendidos</td> -->
                        <td class="text-center align-middle">Monto Referencial</td>
                    </tr>
                </thead>
                <tbody>
                    @for (product of filteredProducts; track $index) {
                    <tr>
                        <th scope="row">{{ product.title }}</th>
                        <td class="text-center">
                            <div class="display">
                                <img [src]="product.image" height="200px" alt="" loading="lazy">
                                <span class="badge text-bg-primary"><fa-icon [icon]="faChartSimple"
                                        class="me-2"></fa-icon>{{ product.quantity }}</span>
                            </div>
                        </td>
                        <td class="text-center">{{ product.variant }}</td>
                        <!-- <td class="text-center">{{ product.quantity }}</td> -->
                        <td class="text-center">{{ product.total_sales | currency:'PEN':'symbol':'1.2-2':'es-PE' }}</td>
                    </tr>
                    }

                    <!-- Fila de total -->
                    <tr class="fw-bold">
                        <td colspan="3" class="text-end">Total</td>
                        <td class="text-center">
                            {{ totalSales | currency:'PEN':'symbol':'1.2-2':'es-PE' }}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

</div>

}