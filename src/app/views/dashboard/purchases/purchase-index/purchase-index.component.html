<div class="bg-white py-3 d-flex justify-content-between align-items-center">
    <span class="ms-3"><fa-icon [icon]="faBagShopping" class="me-2"></fa-icon> Lista de compras
        ({{
        purchases?.length
        }})</span>
    <app-button-add (click)="openVerticallyCentered(content)">Agregar</app-button-add>

</div>

@if(purchases.length == 0){
<div class="empty-state py-4 text-center">
    <fa-icon [icon]="faInbox" style="font-size: 2rem; opacity: 0.5;"></fa-icon>
    <p class="mb-0 mt-3">No hay compras registradas</p>
    <small class="text-muted">Comienza registrando una compra</small>
</div>
}@else{
<div class="table-responsive mb-3">
    <table class="table table-striped table-bordered mb-0 align-middle">
        <tbody>

            <tr>
                <th class="text-center" style="width: 75px;">Cantidad</th>
                <th class="text-center" style="width: 125px;">Unidad</th>
                <th>Insumo</th>
                <th class="text-center">Precio</th>
                <th class="text-center">Total</th>
                <th></th>
                <th></th>
            </tr>

            @for (purchase of purchases; track purchase.id) {

            <tr app-purchase-index-row [purchase]="purchase" [purchaseable_type]="purchaseable_type"
                [purchaseable_id]="purchaseable_id" (emitPurchaseUpdated)="receivePurchaseUpdated($event)"
                (emitRemovePurchase)="receiveRemovePurchase($event)"></tr>

            }

            <tr>
                <td colspan="4" class="text-end"><small class="text-muted"></small></td>
                <td class="text-center">
                    <h6>{{ sum_purchases | currency:'PEN':'symbol':'1.2-2':'es-PE'}}</h6>
                </td>
                <td></td>
                <td></td>
            </tr>

            <!-- <tr>
                <td colspan="7" class="text-end"><small class="text-muted">{{ purchases?.length }} Registros
                        encontrados</small></td>
            </tr> -->

        </tbody>
    </table>
</div>
}




<ng-template #content let-modal>
    <div class="modal-header">
        <h6 class="modal-title">Registrar Compra</h6>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <app-purchase-create [purchaseable_type]="purchaseable_type" [purchaseable_id]="purchaseable_id"
            (emitPurchaseCreate)="receivePurchaseCreate($event)"></app-purchase-create>
    </div>

</ng-template>
<!-- {{ purchaseable_type }} - {{ purchaseable_id }} -->


<!-- 
<ul class="list-group list-group-flush">

    @if(purchases.length > 0){

    @for (purchase of purchases; track purchase.id) {
    <li class="list-group-item px-0 py-0">
        <app-purchase-index-row [purchase]="purchase"
            (deletePurchase)="reListPurchases($event)"></app-purchase-index-row>
    </li>
    }

    }@else{

    Aun no hay compras registrados

    }

</ul> -->