<form [formGroup]="form" (ngSubmit)="create()">

    <div class="row mb-3">

        <!-- <div class="col-lg-6 col-md-6 col-12">
            <app-input-group text="Nombre (*)" [icon]="faEdit">
                <input formControlName="name" type="text" class="form-control" placeholder="Nombre del articulo"
                    [class.is-invalid]="form.get('name')?.invalid && form.get('name')?.touched" aria-label="name"
                    aria-describedby="basic-name" />
            </app-input-group>
        </div> -->

        <div class="col-lg-12 col-md-12 col-12">

            <label class="mb-2">Escoger Proveedor</label>

            <div class="proveedor mb-3 d-flex justify-content-between align-items-center">

                <ng-select class="w-100 me-2" formControlName="supplier_id" bindValue="id" [items]="suppliers"
                    [class.is-invalid]="form.get('supplier_id')?.invalid && form.get('supplier_id')?.touched"
                    [addTag]="false" bindLabel="name" placeholder="Escoja una marca">
                    <ng-template ng-label-tmp let-item="item">
                        <fa-icon [icon]="faUser" class="me-2"></fa-icon>
                        {{ item.name }}
                    </ng-template>
                </ng-select>

                <button type="button" class="btn btn-light d-flex justify-content-between align-items-center"
                    (click)="openVerticallyCentered(newSupplier)">
                    <fa-icon [icon]="faPlus" class="me-2"></fa-icon>
                    <span>Agregar</span>
                </button>

                <!-- <button class="btn btn-outline-primary ms-2">Crear</button> -->

            </div>

        </div>

        <div class="col-12">

            <!-- <app-purchase-product-selected text="Buscar productos"
                (emitProductSizeSelected)="itemSelected($event)"></app-purchase-product-selected>
            <app-product-selected formControlName="name" text="Buscar productos"
                (emitSearchResult)="receiveSearchResult($event, searchResult)"
                [show_result]="false"></app-product-selected> -->
        </div>
        <!-- 
        <div class="col-lg-6 col-6 col-md-6">
            <app-input-group text="Fecha Pedido">
                <input formControlName="purchase_start" type="date" class="form-control" placeholder="Fecha Pedido"
                    aria-label="quantity" aria-describedby="quantity-price" />
            </app-input-group>
        </div>

        <div class="col-lg-6 col-6 col-md-6">
            <app-input-group text="Fecha de entrega">
                <input formControlName="purchase_end" type="date" class="form-control" placeholder="Fecha Entrega"
                    aria-label="quantity" aria-describedby="quantity-price" />
            </app-input-group>
        </div> -->

        <!-- <div class="col-lg-12 col-12">
            <label class="mb-2">Observaciones</label>
            <textarea formControlName="observations" class="form-control mb-3" placeholder="Observaciones"></textarea>
        </div> -->

    </div>

    <div class="d-flex justify-content-start justify-content-lg-end w-100">
        <app-button color="dark" [icon]="faPlus" [spinner]="loadingIcon" (action)="create()">Empezar Orden de
            compra</app-button>
    </div>

</form>

<ng-template #newSupplier let-modal>
    <div class="modal-header">
        <h5 class="modal-title">Crear Fabricante</h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body pb-4">
        <app-supplier-create (emitSupplierCreate)="supplierReceiveCreate($event)"
            button_text="Guardar y crear orden de compra"></app-supplier-create>
    </div>

</ng-template>

<ng-template #searchResult let-modal>

    <div class="modal-header">
        <h5 class="modal-title">Escoger Producto</h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>

    <div class="modal-body pb-4">

        <div class="alert alert-dark">Agregado</div>

        <ul class="list-group mb-3">

            @for (product of products; track product.id) {

            <li class="list-group-item d-flex align-items-center gap-3">

                <img [src]="product.image?.url_thumbnail" alt="" height="100">

                <div class="content-sizes">
                    <p>{{ product.name }}</p>

                    @for (size of product.sizes; track size.id) {
                    <button class="btn btn-outline-primary btn-sm me-2">{{ size.name}}</button>
                    }
                </div>

            </li>

            }

        </ul>
    </div>

</ng-template>